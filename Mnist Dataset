from sklearn.datasets import fetch_openml
from matplotlib import pyplot as plt
from sklearn.linear_model import LogisticRegression
X, y = fetch_openml('mnist_784', version=1, return_X_y=True)

#createing Train and test set

train_size=0.2
train_set=X[:-int(train_size*len(X))]
train_sety=y[:-int(train_size*len(y))]
test_set=X[-int(train_size*len(X)):]
test_sety=y[-int(train_size*len(y)):]
#traing model ------------------

from sklearn.linear_model import LogisticRegression
model=LogisticRegression(tol=0.1)
model.fit(train_set,train_sety)

x=int(input())
print(model.predict([test_set[x]]))
plt.matshow(test_set[x].reshape(28,28))
